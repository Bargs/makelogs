{"version":3,"sources":["../../src/samples/ip_generator.js"],"names":["_","require","module","exports","maxCount","maxSessions","sessions","session","index","length","makeRandom","push","random","splice","getIp"],"mappings":";;;;;;AAAA,IAAMA,IAAIC,QAAQ,QAAR,CAAV;;AAEAC,OAAOC,OAAP;AACE,uBAAYC,QAAZ,EAAsBC,WAAtB,EAAmC;AAAA;;AACjC,SAAKA,WAAL,GAAmBA,WAAnB;AACA,SAAKD,QAAL,GAAgBA,QAAhB;;AAEA,SAAKE,QAAL,GAAgB,EAAhB;AACD;;AANH;AAAA;AAAA,0BAQQ;AACJ,UAAIC,gBAAJ;AACA,UAAIC,cAAJ;;AAEA,UAAI,KAAKF,QAAL,CAAcG,MAAd,GAAuB,KAAKJ,WAAhC,EAA6C;AAC3CE,kBAAU,CAAE,KAAKG,UAAL,EAAF,EAAqB,CAArB,CAAV;AACAF,gBAAQ,KAAKF,QAAL,CAAcG,MAAtB;AACA,aAAKH,QAAL,CAAcK,IAAd,CAAmBJ,OAAnB;AACD,OAJD,MAIO;AACLC,gBAAQR,EAAEY,MAAF,CAAS,CAAT,EAAY,KAAKN,QAAL,CAAcG,MAAd,GAAuB,CAAnC,CAAR;AACAF,kBAAU,KAAKD,QAAL,CAAcE,KAAd,CAAV;AACD;;AAED,UAAID,QAAQ,CAAR,IAAa,KAAKH,QAAtB,EAAgC;AAC9B,aAAKE,QAAL,CAAcO,MAAd,CAAqBL,KAArB,EAA4B,CAA5B;AACA,eAAO,KAAKM,KAAL,EAAP;AACD;;AAED,aAAOP,QAAQ,CAAR,CAAP;AACD;AA3BH;AAAA;AAAA,iCA6Be;AACX,aAAUP,EAAEY,MAAF,CAAS,CAAT,EAAY,GAAZ,CAAV,SACEZ,EAAEY,MAAF,CAAS,CAAT,EAAY,GAAZ,CADF,SAEEZ,EAAEY,MAAF,CAAS,CAAT,EAAY,GAAZ,CAFF,SAGEZ,EAAEY,MAAF,CAAS,CAAT,EAAY,GAAZ,CAHF;AAID;AAlCH;;AAAA;AAAA","file":"ip_generator.js","sourcesContent":["const _ = require('lodash')\n\nmodule.exports = class IpGenerator {\n  constructor(maxCount, maxSessions) {\n    this.maxSessions = maxSessions\n    this.maxCount = maxCount\n\n    this.sessions = []\n  }\n\n  get() {\n    let session\n    let index\n\n    if (this.sessions.length < this.maxSessions) {\n      session = [ this.makeRandom(), 0 ]\n      index = this.sessions.length\n      this.sessions.push(session)\n    } else {\n      index = _.random(0, this.sessions.length - 1)\n      session = this.sessions[index]\n    }\n\n    if (session[1] > this.maxCount) {\n      this.sessions.splice(index, 1)\n      return this.getIp()\n    }\n\n    return session[0]\n  }\n\n  makeRandom() {\n    return `${_.random(0, 255)}.${\n      _.random(0, 255)}.${\n      _.random(0, 255)}.${\n      _.random(0, 255)}`\n  }\n}\n"]}